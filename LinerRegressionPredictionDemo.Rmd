---
title: "Liner Regression for Prediction"
author: "Silpa Velagapudi"
date: "September 7, 2019"
output: html_document
---
```{r}

library(HistData)
set.seed(1983,sample.kind="Rounding")

```

```{r}
galton_heights <- GaltonFamilies %>%
  filter(gender == "male") %>%
  group_by(family) %>%
  sample_n(1) %>%
  ungroup() %>%
  select(father, childHeight) %>%
  rename(son = childHeight)

y <- galton_heights$son
test_index <- createDataPartition(y, times = 1, p = 0.5, list = FALSE)
train_set <- galton_heights %>% slice(-test_index)
test_set <- galton_heights %>% slice(test_index)

m <- mean(train_set$son)
m
```

```{r}
# squared loss
mean((m - test_set$son)^2)


```

```{r}
# fit linear regression model
fit <- lm(son ~ father, data = train_set)
fit$coef
y_hat <- fit$coef[1] + fit$coef[2]*test_set$father
mean((y_hat - test_set$son)^2)
```

```{r}
y_hat <- predict(fit, test_set)
mean((y_hat - test_set$son)^2)
```

